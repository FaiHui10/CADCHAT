# CADChat - AI辅助CAD制图工具

CADChat是一个创新的AI辅助CAD制图工具，通过自然语言理解技术，帮助用户快速生成和执行CAD命令。

## 功能特点

### 1. 智能命令匹配
- 通过云端向量数据库进行语义匹配
- 支持显示前3个最匹配的命令结果
- 提供置信度评分，帮助用户选择最佳匹配

### 2. 多种代码生成方式
- **智能查询（服务器）**: 从云端代码库中查找匹配的命令
- **生成LISP文件**: 通过AI生成LISP代码
- **生成并执行**: 一键生成代码并发送到CAD执行
- **执行当前代码**: 执行已有的LISP代码

### 3. 用户友好的界面设计
- 现代化的GUI界面，直观易用
- 服务器匹配结果面板，清晰展示前3个匹配结果
- LISP代码编辑器，支持代码查看和编辑
- 运行日志面板，实时跟踪操作状态

### 4. 双击交互功能
- 服务器匹配结果默认只显示命令信息
- 双击任意结果行可显示对应LISP代码
- 代码区域在双击后自动展开

### 5. CAD集成
- 支持与AutoCAD和中望CAD无缝集成
- 自动检测并连接运行中的CAD程序
- 一键执行LISP代码到CAD

### 6. 代码管理
- 支持保存自定义LISP代码到云端
- 代码分类管理，便于后续复用
- 查看历史记录和热门代码

## 系统架构

```
┌─────────────┐    ┌──────────────┐    ┌──────────────┐
│   客户端    │◄──►│   云端服务   │◄──►│  向量数据库  │
│ (GUI应用)   │    │ (Flask API)  │    │ (FAISS)      │
└─────────────┘    └──────────────┘    └──────────────┘
       │
       ▼
┌─────────────┐
│   CAD软件   │
│(AutoCAD等)  │
└─────────────┘
```

## 部署说明

### 阿里云ECS部署

1. 确保ECS实例已安装Python 3.8+
2. 配置DASHSCOPE_API_KEY环境变量
3. 安装依赖：`pip install -r requirements.txt`
4. 启动服务器：`python server.py`
5. 客户端配置服务器地址为ECS公网IP

### 本地部署

1. 安装Python 3.8+
2. 安装CAD软件（AutoCAD或中望CAD）
3. 配置环境变量
4. 安装依赖并启动服务

## 使用方法

1. 启动应用后，首先连接CAD软件
2. 输入功能需求，如"画一个半径为50的圆"
3. 点击"智能查询（服务器）"查找匹配命令
4. 查看前3个匹配结果及其置信度
5. 双击结果行查看LISP代码
6. 选择合适的命令并执行

## 技术栈

- **前端**: Tkinter GUI
- **后端**: Flask Web框架
- **向量数据库**: FAISS
- **嵌入模型**: DashScope文本嵌入
- **通信协议**: HTTP REST API
- **数据存储**: SQLite（本地），云存储（服务器）

## 环境要求

- Python 3.8+
- AutoCAD或中望CAD
- 稳定网络连接（访问云端服务）

## 项目组成

- `main_gui_cloud.py`: 主界面应用
- `cloud_client.py`: 云端API客户端
- `server.py`: Flask服务器
- `vector_db.py`: 向量数据库接口
- `cad_connector.py`: CAD连接器
- `kimi_browser.py`: AI代码生成器

## 维护与扩展

系统采用模块化设计，易于维护和扩展：
- 新增命令只需添加到向量数据库
- 支持多种CAD软件接入
- 可扩展更多AI能力